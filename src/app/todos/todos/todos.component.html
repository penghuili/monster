<div [mstPadding]="'0 0 1rem'" *ngIf="showSearch">
  <mst-search-todos [todos]="todos"></mst-search-todos>
</div>


<div fxLayout="row" fxLayoutAlign="space-between" [mstPadding]="'0 0 1rem'">
  <div class="mst-todos-tab" [class.mst-todos-tab--active]="activeTab === OVERDUE" [mstColor]="'error'" (click)="onChangeTab(OVERDUE)">overdue</div>
  <div class="mst-todos-tab mst-todos-tab-today" [class.mst-todos-tab--active]="activeTab === TODAY" (click)="onChangeTab(TODAY)">
    <div>today</div>
    <div class="mst-start-today" *ngIf="hasActive && isStartTodayEnabled()" (click)="onStartToday()">start</div>
  </div>
  <div class="mst-todos-tab" [class.mst-todos-tab--active]="activeTab === TOMORROW" (click)="onChangeTab(TOMORROW)">tomorrow</div>
  <div class="mst-todos-tab" [class.mst-todos-tab--active]="activeTab === THISWEEK" (click)="onChangeTab(THISWEEK)">week</div>
</div>

<ng-container *ngIf="activeTab === TODAY && habits && habits.length > 0">
  <div>Habits</div>
  <div [mstPadding]="'0 0 0.5rem 1rem'">
    <mst-habit-item *ngFor="let habit of habits"
      [habit]="habit"
      (click)="onShowHabitDetail(habit)">
    </mst-habit-item>
  </div>
</ng-container>

<ng-container *ngIf="activeProjectsWithTodos && activeProjectsWithTodos.length > 0">
  <div *ngFor="let pwts of activeProjectsWithTodos">
    <div *ngIf="pwts.todos.length > 0">
      {{pwts.project.title}} {{ pwts.todos | expectedTime | minuteFormatter }}
    </div>
    <div [mstPadding]="'0.5rem 0 0.5rem 1rem'" *ngIf="pwts.todos.length > 0">
      <mst-drop-zone [dragIndex]="dragIndex" (drop)="onDrop($event, pwts.project.id)">
        <mst-drag-item *ngFor="let todo of pwts.todos; let i = index;"
          [item]="todo"
          [index]="i"
          (start)="onDragStart($event, pwts.project.id)">
          <mst-todo-item
            [todo]="todo"
            (click)="onShowDetail(todo)">
          </mst-todo-item>
        </mst-drag-item>
      </mst-drop-zone>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="hasDone && activeTab === TODAY">
  <div [mstTextAlign]="'center'" [mstPadding]="'2rem 0 0'">Done</div>
  <div *ngFor="let pwts of doneProjectsWithTodos">
    <div [mstPadding]="'0.5rem 0 0'" *ngIf="pwts.todos.length > 0">
      {{pwts.project.title}}
    </div>
    <div [mstPadding]="'0.5rem 0 0.5rem 1rem'" *ngIf="pwts.todos.length > 0">
      <mst-todo-item *ngFor="let todo of pwts.todos"
        [todo]="todo"
        (click)="onShowDetail(todo)">
      </mst-todo-item>
    </div>
  </div>
</ng-container>
